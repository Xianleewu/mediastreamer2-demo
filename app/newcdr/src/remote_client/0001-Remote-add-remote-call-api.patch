From 32df6c2d2bdaa99915f560115ef9a4c415452f81 Mon Sep 17 00:00:00 2001
From: yuyz <yuyz@rock-chips.com>
Date: Tue, 12 Jul 2016 16:29:56 +0800
Subject: [PATCH] Remote: add remote call api

---
 src/remote/RemoteBuffer.cpp        | 3 +--
 src/remote_client/screenrecord.cpp | 5 +++++
 src/remote_client/screenrecord.h   | 2 +-
 src/window/RecordPreview.cpp       | 2 +-
 4 files changed, 8 insertions(+), 4 deletions(-)

diff --git a/src/remote/RemoteBuffer.cpp b/src/remote/RemoteBuffer.cpp
index 09f4f77..ad7e4d2 100755
--- a/src/remote/RemoteBuffer.cpp
+++ b/src/remote/RemoteBuffer.cpp
@@ -147,8 +147,7 @@ int RemoteBufferWrapper::call(unsigned char *buf, int size) {
 		return -1;
 	}
 
-	mservice->call(mclient, buf, size);
-	return 0;
+	return mservice->call(mclient, buf, size);
 }
 
 int RemoteBufferWrapper::disconnect(void) {
diff --git a/src/remote_client/screenrecord.cpp b/src/remote_client/screenrecord.cpp
index 659190b..24bab41 100755
--- a/src/remote_client/screenrecord.cpp
+++ b/src/remote_client/screenrecord.cpp
@@ -201,4 +201,9 @@ bool JoinRecordThread() {
 bool QueryScreenFormat(int *width, int *height, int *mFps, int *fourcc) {
     return true;
 }
+
+int RemoteCall(unsigned char *buf, int length) {
+        return service.call(buf, length);
+}
+
 }
diff --git a/src/remote_client/screenrecord.h b/src/remote_client/screenrecord.h
index 3fcdaf3..6bcdbc4 100755
--- a/src/remote_client/screenrecord.h
+++ b/src/remote_client/screenrecord.h
@@ -44,7 +44,7 @@ public:
         virtual void OnFrame(struct ScreenFrame &frame) = 0;
         virtual ~ScreenRecordCallback(){}
 };
-
+int RemoteCall(unsigned char *buf, int length);
 bool StartScreenRecordThread(int width, int height, ScreenRecordCallback *callback);
 bool StopScreenRecordThread();
 bool IsScreenRecordThreadRunning();
diff --git a/src/window/RecordPreview.cpp b/src/window/RecordPreview.cpp
index 8070917..83d9560 100755
--- a/src/window/RecordPreview.cpp
+++ b/src/window/RecordPreview.cpp
@@ -2536,7 +2536,7 @@ void RecordPreview::returnFrame(struct PreviewBuffer *pBuf)
 
 
 void RecordPreview::call(unsigned char *pbuf, int size) {
-    ALOGD("RecordPreview::call \n");
+    ALOGD("RecordPreview::call cmd :%s, len %d\n", pbuf, size);
 }
 
 void RecordPreview::releaseBuffer(unsigned char *pbuf, int size) {
-- 
1.9.1

